apiVersion: apps/v1
kind: Deployment
metadata:
  name: sister-backend
spec:
  replicas: 2 # ğŸ’¡ K8s æœƒå¹«å¦³è·‘å…©å€‹å¾Œç«¯ï¼Œå£æ‰ä¸€å€‹å¦ä¸€å€‹æœƒé ‚ä½
  selector:
    matchLabels:
      app: sister-backend
  template:
    metadata:
      labels:
        app: sister-backend
    spec:
      containers:
      - name: backend
        image: sister-backend:latest # ğŸ’¡ ä½¿ç”¨å¦³å‰›å‰›æ‰“åŒ…çš„ Image
        imagePullPolicy: Never # ğŸ’¡ æ¸¬è©¦æ™‚å…ˆç”¨æœ¬åœ° Image
        ports:
        - containerPort: 8080
        env:
        - name: SPRING_DATASOURCE_URL
          value: "jdbc:postgresql://sister-db-service:5432/sister_cms"
        - name: SPRING_DATASOURCE_USERNAME
          value: "admin"
        - name: SPRING_DATASOURCE_PASSWORD
          value: "password123"
---
apiVersion: v1
kind: Service
metadata:
  name: sister-backend-service
spec:
  type: NodePort # ğŸ’¡ è®“å¦³å¯ä»¥å¾é›»è…¦ç€è¦½å™¨é€£é€²å»
  selector:
    app: sister-backend
  ports:
    - port: 8080
      targetPort: 8080
      nodePort: 30080 # ğŸ’¡ ä¹‹å¾Œè¨ªå• http://localhost:30080